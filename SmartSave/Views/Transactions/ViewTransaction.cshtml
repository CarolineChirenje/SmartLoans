@model SmartDomain.Transaction
@using SmartHelper;
<section class="content-header">
    <h1>
        @Model.TransRef
    </h1>
</section>
<!-- Main content -->
<section class="content container-fluid">
    <!-- Horizontal Form -->
    <div class="box box-info">
        <div class="box-header with-border">

            <h3 class="box-title">@Model.TransactionType.Name</h3>
        </div>
        <!-- /.box-header -->
        <!-- form start -->
        <form class="form-horizontal" method="post" action="ViewTransaction">
            @if (ViewData["Error"] != null)
            {<div class="container">
                    <strong class="">@ViewData["Error"].ToString()</strong>
                    <div class="panel panel-danger">
                        <div class="panel-body">@Html.ValidationSummary()</div>
                    </div>

                </div>
            }
        <div class="box-body">

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Transaction Ref</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="TransRef" disabled="disabled" value="@Model.TransRef">
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Bank Account</label>
                <div class="col-sm-10">
                    <select asp-for="BankAccountID" class="form-control" asp-items="ViewBag.BankAccountList">
                        <option value="">----</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Transaction Date</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="TransactionDate" disabled="disabled" value="@UtilityService.ShowDateTime(@Model.TransactionDate)">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Payment Date</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="PaymentDate" disabled="disabled" value="@UtilityService.ShowDateTime(Model.PaymentDate)">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Client Details</label>
                <div class="col-sm-10">
                    <a asp-controller="Client" asp-action="ViewClient" asp-route-id="@Model.ClientID">@Model.Client.ClientRef</a>
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Transaction Type</label>
                <div class="col-sm-10">

                    <input type="text" class="form-control" name="TransactionTypeID" disabled="disabled" value="@Model.TransactionType.Name">
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Payment Type</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" disabled="disabled" value="@Model.Product.Name">
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Amount Excl VAT</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="AmountExclVAT" disabled="disabled" value="@Model.AmountExclVAT">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">VAT</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="VAT" disabled="disabled" value="@Model.VAT">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Amount Incl VAT</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="Amount" disabled="disabled" value="@Model.Amount">
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Discount</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="Discount" disabled="disabled" value="@Model.Discount ">
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Total Paid</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="TotalPaid" disabled="disabled" value="@Model.TotalPaid">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Payment Status</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" name="Payment" disabled="disabled" value="@Model.PaymentStatus.Name">
                </div>
            </div>
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Last Changed By</label>
                <div class="col-sm-10">
                    <label for="inputEmail3" class="form-control label-default">@Model.LastChangedBy</label>
                </div>
            </div>

            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">Last Updated</label>
                <div class="col-sm-10">
                    <label for="inputEmail3" class="form-control label-default">@UtilityService.ShowDateTime(@Model.LastChangedDate)</label>
                </div>
            </div>
            <input type="hidden" name="TransactionID" value="@Model.TransactionID" />
          
        </div>
            <!-- /.box-body -->
            <div class="box-footer">

                @{

                    switch ((TransactionTypeList)Model.TransactionTypeID)
                    {
                        case TransactionTypeList.Payment:
                            int transactionTypeID = (int)TransactionTypeList.Reversal;
                            if (UtilityService.HasPermission(Permissions.Reverse_Payment))
                            {
                                if (Model.PaymentStatusID != (int)PaymentState.Reversed)
                                {
                                <a class="btn btn-danger"  asp-controller="Transactions" asp-action="ActionTransaction" asp-route-id="@Model.TransactionID" asp-route-transactionTypeID="@transactionTypeID">Reverse Transaction</a>
                                }
                            }
                            transactionTypeID = (int)TransactionTypeList.Void;
                            if (Model.PaymentStatusID != (int)PaymentState.Pending)
                            {
                                if (UtilityService.HasPermission(Permissions.Void_Payment))
                                {
                                <a class="btn btn-warning" asp-controller="Transactions" asp-action="ViewTransaction" asp-route-id="@Model.TransactionID" asp-route-transactionTypeID="@transactionTypeID">Void Transaction</a>
                                }

                            }
                            transactionTypeID = (int)TransactionTypeList.Refund;
                            if (Model.PaymentStatusID != (int)PaymentState.Pending)
                            {
                                if (UtilityService.HasPermission(Permissions.Refund_Payment))
                                {
                                <a class="btn btn-success" asp-controller="Transactions" asp-action="ViewTransaction" asp-route-id="@Model.TransactionID" asp-route-transactionTypeID="@transactionTypeID">Refund Transaction</a>
                                }
                            }
                            break;
                        case TransactionTypeList.Reversal:
                            break;
                        case TransactionTypeList.Refund:
                            transactionTypeID = (int)TransactionTypeList.Void;
                            if (UtilityService.HasPermission(Permissions.Void_Payment))
                            {
                                <a class="btn btn-warning" asp-controller="Transactions" asp-action="ViewTransaction" asp-route-id="@Model.TransactionID" asp-route-transactionTypeID="@transactionTypeID">Void Transaction</a>
                            }
                            break;
                        case TransactionTypeList.Void:
                            break;
                        default:
                            break;

                    }
                }
                <a class="btn btn-primary" asp-controller="Transactions" asp-action="PrintTransaction" asp-route-id="@Model.TransactionID">Print</a>
                <a class="btn btn-default" asp-controller="Transactions" asp-action="Transactions">Cancel</a>
            </div>
            <!-- /.box-footer -->
        </form>
    </div>
    <!-- /.box -->
</section>

